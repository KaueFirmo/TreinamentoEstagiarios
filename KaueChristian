CREATE DOMAIN BOOLEAN_CHAR AS CHAR(1) 
  CHECK (VALUE IN ('S', 'N'));

CREATE DOMAIN CODIGO AS VARCHAR(20) NOT NULL;

CREATE TABLE CLIENTE (
  ID INTEGER NOT NULL,
  NOME VARCHAR(100) NOT NULL,
  CPF_CNPJ VARCHAR(14),
  TELEFONE VARCHAR(15),
  DATA_CADASTRO DATE DEFAULT CURRENT_DATE,
  ATIVO BOOLEAN_CHAR DEFAULT 'S',
  CONSTRAINT PK_CLIENTE PRIMARY KEY (ID)
);

CREATE TABLE PRODUTO (
  ID INTEGER NOT NULL,
  CODIGO CODIGO,
  DESCRICAO VARCHAR(100) NOT NULL,
  PRECO_CUSTO NUMERIC(10,2),
  PRECO_VENDA NUMERIC(10,2),
  ESTOQUE INTEGER DEFAULT 0,
  ATIVO BOOLEAN_CHAR DEFAULT 'S',
  CONSTRAINT PK_PRODUTO PRIMARY KEY (ID)
);

CREATE TABLE VENDA (
  ID INTEGER NOT NULL,
  DATA_VENDA TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  CLIENTE_ID INTEGER,
  VALOR_TOTAL NUMERIC(10,2),
  CONSTRAINT PK_VENDA PRIMARY KEY (ID),
  CONSTRAINT FK_VENDA_CLIENTE FOREIGN KEY (CLIENTE_ID) REFERENCES CLIENTE(ID)
);

CREATE TABLE ITEM_VENDA (
  VENDA_ID INTEGER NOT NULL,
  PRODUTO_ID INTEGER NOT NULL,
  QUANTIDADE INTEGER NOT NULL,
  VALOR_UNITARIO NUMERIC(10,2),
  CONSTRAINT PK_ITEM_VENDA PRIMARY KEY (VENDA_ID, PRODUTO_ID),
  CONSTRAINT FK_ITEM_VENDA_VENDA FOREIGN KEY (VENDA_ID) REFERENCES VENDA(ID),
  CONSTRAINT FK_ITEM_VENDA_PRODUTO FOREIGN KEY (PRODUTO_ID) REFERENCES PRODUTO(ID)
);
